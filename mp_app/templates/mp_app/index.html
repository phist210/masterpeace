{% extends 'mp_app/base.html' %}
{% load staticfiles %}

{% block content %}

{% include 'mp_app/menubar.html' %}

{% if user.is_authenticated %}
  <div class='gallery'>
    {% csrf_token %}
    <div data-aos='fade' class='right_arrow'>
      <i class="fa fa-long-arrow-right fa-5x" aria-hidden="true"></i>
    </div>

  {% for mp in all_mps %}
  <!-- Begin text mp div -->
    {% if mp.text %}
      <div class='posts_txt' id='{{mp.id}}'>
        <span class='post_title'>{{mp.title}}</span></br>
        {{mp.text}}</br></br>

        {% for tag in mp.tag.all %}
          <span class='tag'><a href='/text_tags/{{tag.id}}'>#{{tag}}</a></span>
        {% endfor %}
        </br>

        {% if user.is_authenticated and mp.owner_id == user.id %}
          <p>Posted by: <a href='/profile/{{mp.owner_id}}'>You</a>, {{mp.created}}</p>
          <p><span class='edit_text'><a href='/edit_text/{{mp.id}}'><i class="fa fa-pencil" aria-hidden="true"></i></a></span>
            {{mp.id}}
          <a href='#'><span class='delete_text' id='{{mp.id}}'><i class="fa fa-trash-o" aria-hidden="true"></i></span></a></p>
        {% else %}
          <p>Posted by: <a href='/profile/{{mp.owner_id}}'>{{mp.owner}}</a>, {{mp.created}}</p>
        {% endif %}

        </br></br>

        {% if mp.allow_feedback %}
          <form name='feedbackData' id='feedbackData' method='post'>
            {% csrf_token %}
            <input id='critic_id' type='text' name='critic_id' value={{user.id}} style='display:none'>
            <input id='masterpeace_id' type='text' name='masterpeace_id' value={{mp.id}} style='display:none'>
          </form>
          <div class='feedback'>
            <table class='feedback_bar'>
              <td>
                <a class='text_feedback_button' id='1'><i class="fa fa-quora" aria-hidden="true"></i>
                  <div class='counter' id='1'>{{mp.feedback1}}</div>
                </a>
              </td>
              <td>
                <a class='text_feedback_button' id='2'><i class="fa fa-meetup" aria-hidden="true"></i>
                  <div class='counter' id='2'>{{mp.feedback2}}</div>
                </a>
              </td>
              <td>
                <a class='text_feedback_button' id='3'><i class="fa fa-superpowers" aria-hidden="true"></i>
                  <div class='counter' id='3'>{{mp.feedback3}}</div>
                </a>
              </td>
              <td>
                <a class='text_feedback_button' id='4'><i class="fa fa-microchip" aria-hidden="true"></i>
                  <div class='counter' id='4'>{{mp.feedback4}}</div>
                </a>
              </td>
              <td>
                <a class='text_feedback_button' id='5'><i class="fa fa-anchor" aria-hidden="true"></i>
                  <div class='counter' id='5'>{{mp.feedback5}}</div>
                </a>
              </td>
            </table>
          </div>
        {% endif %}
      </div>
      <!-- End text mp div -->
    {% elif mp.image %}
      <!-- Begin image mp div -->
      <div class='posts_img' id='{{mp.id}}'>
        <div class='image_itself'>
          <img class='masterpeace' src="{{mp.image}}"/>
        </div>
        <div class='image_info'>
          <span class='post_title'>{{mp.title}}</span></br>
          {{mp.caption}}</br></br>

          {% for tag in mp.tag.all %}
            <span class='tag'><a href='/image_tags/{{tag.id}}'>#{{tag}}</a></span>
          {% endfor %}

          {% if user.is_authenticated and mp.owner_id == user.id %}
            <p>Posted by: <a href='/profile/{{mp.owner_id}}'>You</a>, {{mp.created}}</p>
            <p><span class='edit_image'><a href='/edit_image/{{mp.id}}'><i class="fa fa-pencil" aria-hidden="true"></i></a></span>
            <a href='#'><span class='delete_image' id='{{mp.id}}'><i class="fa fa-trash-o" aria-hidden="true"></i></span></a></p>
          {% else %}
            <p>Posted by: <a href='/profile/{{mp.owner_id}}'>{{mp.owner}}</a>, {{mp.created}}</p>
          {% endif %}

          </br></br>

          {% if mp.allow_feedback %}

            <form name='feedbackData' id='feedbackData' method='post'>
              {% csrf_token %}
              <input id='critic_id' type='text' name='critic_id' value={{user.id}} style='display:none'>
              <input id='masterpeace_id' type='text' name='masterpeace_id' value={{mp.id}} style='display:none'>
            </form>
            <div class='feedback'>
              <table class='feedback_bar'>
                <td>
                  <a class='image_feedback_button' id='1'><i class="fa fa-quora" aria-hidden="true"></i>
                    <div class='counter' id='1'>{{mp.feedback1}}</div>
                  </a>
                </td>
                <td>
                  <a class='image_feedback_button' id='2'><i class="fa fa-meetup" aria-hidden="true"></i>
                    <div class='counter' id='2'>{{mp.feedback2}}</div>
                  </a>
                </td>
                <td>
                  <a class='image_feedback_button' id='3'><i class="fa fa-superpowers" aria-hidden="true"></i>
                    <div class='counter' id='3'>{{mp.feedback3}}</div>
                  </a>
                </td>
                <td>
                  <a class='image_feedback_button' id='4'><i class="fa fa-microchip" aria-hidden="true"></i>
                    <div class='counter' id='4'>{{mp.feedback4}}</div>
                  </a>
                </td>
                <td>
                  <a class='image_feedback_button' id='5'><i class="fa fa-anchor" aria-hidden="true"></i>
                    <div class='counter' id='5'>{{mp.feedback5}}</div>
                  </a>
                </td>
              </table>
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}
  {% endfor %}
  </div>
{% else %}

  <div class='signup_splash'>
    <img class='splash' src="{% static 'base_images/bob.png' %}">
  </div>

  <a class='signup_button' href='/signup'>Sign up and post your masterpeace!</a>
{% endif %}


<div class='footer'>
  Masterpeace Â© 2017 | <a href='/privacy'>Privacy Policy</a> | Find us on <a href='https://github.com/willwile4/masterpeace'>GitHub!</a>
</div>

{% endblock %}
{% block javascript %}
<script src='{% static "js/feedback.js" %}'></script>
<script src='{% static "js/deleteText.js" %}'></script>
<script src='{% static "js/feedback.js" %}'></script>
<script src='{% static "js/bin-ascii.js" %}'></script>
{% endblock %}
